---
import BaseLayout from '../layouts/BaseLayout.astro';
import BlogPost from '../components/BlogPost.astro'

const pageTitle = "Marty's blog";

const allPosts = await Astro.glob('../pages/posts/*.md');
const allTags = [...new Set(allPosts.map((post) => post.frontmatter.tags).flat())];
---

<BaseLayout title={pageTitle}>
    <h1>{pageTitle}</h1>

    <section class="posts">
    <ul>
        {allPosts.map((post) => <BlogPost url={post.url} title={post.frontmatter.title} description={post.frontmatter.description} pubDate={post.frontmatter.pubDate} tags={post.frontmatter.tags}/> )}
    </ul>
    </section>
    <section class="tags">
    <h2>Tags</h2>
    {allTags.map((tag) => <a href={"/tags/" + tag} class="tag">{tag}</a>)}
    </section>
</BaseLayout>

<style>
a.tag {
    appearance: button;
    display: inline;
    padding: 1rem;
}

.tags {
    margin: 2rem 1rem;
}
</style>
